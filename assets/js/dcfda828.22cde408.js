"use strict";(self.webpackChunkcodebase_doctor_docs=self.webpackChunkcodebase_doctor_docs||[]).push([[6674],{2437:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>c});var s=n(5893),i=n(1151);const a={sidebar_position:1},r="Next.js (App Router)",o={id:"install/javascript/nextjs",title:"Next.js (App Router)",description:"You can install the client library for Next.js to immediately get the full feature set of Catalyst, including:",source:"@site/docs/install/javascript/nextjs.md",sourceDirName:"install/javascript",slug:"/install/javascript/nextjs",permalink:"/docs/install/javascript/nextjs",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Javascript/Typescript",permalink:"/docs/category/javascripttypescript"},next:{title:"SvelteKit",permalink:"/docs/install/javascript/sveltekit"}},l={},c=[{value:"Add the dependency",id:"add-the-dependency",level:2},{value:"Update your Next.js config",id:"update-your-nextjs-config",level:2},{value:"Add the CatalystInstaller component",id:"add-the-catalystinstaller-component",level:2},{value:"Propagate Session Info",id:"propagate-session-info",level:2},{value:"Limitations",id:"limitations",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"nextjs-app-router",children:"Next.js (App Router)"}),"\n",(0,s.jsxs)(t.p,{children:["You can install the client library for ",(0,s.jsx)(t.a,{href:"https://nextjs.org/",children:"Next.js"})," to immediately get the full feature set of Catalyst, including:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Frontend navigation, error reporting, and click tracking"}),"\n",(0,s.jsx)(t.li,{children:"Server logs, request, and error reporting"}),"\n",(0,s.jsx)(t.li,{children:"Session tracking across the stack"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["For other languages and frameworks, checkout our ",(0,s.jsx)(t.a,{href:"/docs/category/install-catalyst",children:"other installation guides"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Before you start, you'll need to sign up for Catalyst and have your keys ready, as detailed ",(0,s.jsx)(t.a,{href:"/docs/signup",children:"here"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"add-the-dependency",children:"Add the dependency"}),"\n",(0,s.jsx)(t.p,{children:"To get started, add the Catalyst dependencies:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",metastring:'title="Terminal"',children:"npm install @catalyst-monitor/nextjs\n\n# Alternatively, if you use Yarn:\nyarn add @catalyst-monitor/nextjs\n"})}),"\n",(0,s.jsx)(t.h2,{id:"update-your-nextjs-config",children:"Update your Next.js config"}),"\n",(0,s.jsxs)(t.p,{children:["Wrap your existing Next.js configuration with ",(0,s.jsx)(t.code,{children:"withCatalystConfig"}),". This will auto-instrument Catalyst code for your entire Next.js app."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",metastring:'title="next.config.mjs"',children:"import * as catalystConfig from '@catalyst-monitor/nextjs/config'\nimport catalyst from './catalyst.mjs'\n\n/** @type {import('next').NextConfig} */\nexport default catalystConfig.withCatalystConfig(\n  {\n    // Optional but suggested:\n    // Strict Mode causes effects to be ran twice in dev mode.\n    // Since Catalyst sometimes runs in effects, this causes\n    // double-reporting of events.\n    reactStrictMode: false,\n\n    // Your existing Next.js configuration here...\n  },\n  {\n    systemName: 'catalyst-nextjs-example', // The name given to this service. All endpoints will be grouped by this name.\n    publicKey: 'YOUR PUBLIC KEY HERE', // The public key from the \"Settings\" page in the Catalyst dashboard.\n    privateKey: 'YOUR PRIVATE KEY HERE', // The private key from the \"Settings\" page in the Catalyst dashboard.\n    version: 'YOUR VERSION CODE HERE', // Any to differentiate different deploys, e.g. Git commit SHA\n  }\n)\n"})}),"\n",(0,s.jsx)(t.h2,{id:"add-the-catalystinstaller-component",children:"Add the CatalystInstaller component"}),"\n",(0,s.jsxs)(t.p,{children:["As soon as possible, add the ",(0,s.jsx)(t.code,{children:"CatalystInstaller"})," component. This component will ensure everything happening client-side is captured. We recommend adding this in the root layout, if possible."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",metastring:'title="layout.ts"',children:"import { CatalystInstaller } from '@catalyst-monitor/nextjs/server'\n\nexport default function Layout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return <>\n    <CatalystInstaller />\n    {children}\n  </>\n}\n"})}),"\n",(0,s.jsx)(t.h2,{id:"propagate-session-info",children:"Propagate Session Info"}),"\n",(0,s.jsxs)(t.p,{children:["To ensure session info is correctly propagated, simply replace ",(0,s.jsx)(t.code,{children:"fetch(...)"})," calls to servers with the provided ",(0,s.jsx)(t.code,{children:"catalystNextJSFetch"}),". If the backend has Catalyst installed, then the request will be associated with the calling session. ",(0,s.jsx)(t.code,{children:"catalystNextJSFetch"})," will work inside both server and client components."]}),"\n",(0,s.jsxs)(t.p,{children:["Note that ",(0,s.jsx)(t.code,{children:"catalystNextJSFetch"})," has the same interface as ",(0,s.jsx)(t.code,{children:"fetch"}),", so you can simply drop the new function in."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",metastring:'title="api.ts"',children:"import { catalystNextJSFetch as cFetch } from '@catalyst-monitor/nextjs'\n\nawait cFetch(\"https://.../api/widget/123\", {\n  method: method,\n})\n"})}),"\n",(0,s.jsx)(t.h2,{id:"limitations",children:"Limitations"}),"\n",(0,s.jsx)(t.p,{children:"Currently, the Next.JS client library has the following limitations:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Does not support Page Router"}),"\n",(0,s.jsx)(t.li,{children:"Server Actions are not auto-instrumented"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["If you require any of those features, please ",(0,s.jsx)(t.a,{href:"mailto:bill@privium.xyz",children:"get in touch"}),"."]})]})}function h(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>o,a:()=>r});var s=n(7294);const i={},a=s.createContext(i);function r(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);