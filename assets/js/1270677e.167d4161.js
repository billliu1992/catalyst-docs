"use strict";(self.webpackChunkcodebase_doctor_docs=self.webpackChunkcodebase_doctor_docs||[]).push([[892],{5922:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>d});var r=n(5893),a=n(1151);const s={sidebar_position:6},i="Other Node.JS Server Framework",o={id:"install/javascript/other-node",title:"Other Node.JS Server Framework",description:"Before you manually instrument, please check if we provide a package for your choice of HTTP server! If we don't provide a package, we'd",source:"@site/docs/install/javascript/other-node.md",sourceDirName:"install/javascript",slug:"/install/javascript/other-node",permalink:"/docs/install/javascript/other-node",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Other Web Frameworks",permalink:"/docs/install/javascript/other-web"},next:{title:"Kotlin/Java",permalink:"/docs/category/kotlinjava"}},l={},d=[{value:"Add the dependency",id:"add-the-dependency",level:2},{value:"Initialize the library",id:"initialize-the-library",level:2},{value:"Instrumenting",id:"instrumenting",level:2},{value:"Recording an HTTP Request",id:"recording-an-http-request",level:3},{value:"(Optional) Associating User Info",id:"optional-associating-user-info",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,a.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h1,{id:"other-nodejs-server-framework",children:"Other Node.JS Server Framework"}),"\n",(0,r.jsx)(t.admonition,{type:"note",children:(0,r.jsxs)(t.p,{children:["Before you manually instrument, please check if we provide a package for your choice of HTTP server! If we don't provide a package, we'd\nstill like to work with you. Please reach out either ",(0,r.jsx)(t.a,{href:"mailto:bill@privium.xyz",children:"through e-mail"})," or ",(0,r.jsx)(t.a,{href:"https://discord.gg/YQZy4SXzmX",children:"via Discord"}),"."]})}),"\n",(0,r.jsxs)(t.p,{children:["For a working example, please checkout our ",(0,r.jsx)(t.a,{href:"https://github.com/catalyst-monitor/catalyst-examples",children:"examples repo"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"add-the-dependency",children:"Add the dependency"}),"\n",(0,r.jsx)(t.p,{children:"To get started, add the core Javascript library to your Node.js application:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",metastring:'title="Terminal"',children:"npm install @catalyst-monitor/server@^0.1.1\n\n# Alternatively, if you use Yarn:\nyarn add @catalyst-monitor/server@^0.1.1\n"})}),"\n",(0,r.jsx)(t.h2,{id:"initialize-the-library",children:"Initialize the library"}),"\n",(0,r.jsx)(t.p,{children:"Initialize the library as early as possible:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",metastring:'title="index.ts"',children:'import Catalyst from "@catalyst-monitor/server";\n\nCatalyst.start({\n  privateKey: "<YOUR PRIVATE KEY HERE>", // The private key from the "Settings" page in the Catalyst dashboard.\n  systemName: "catalyst-js-express-example", // Any string to differentiate this service.\n  version: "<YOUR VERSION CODE HERE>", // Any string to differentiate different deploys, e.g. Git commit SHA\n});\n'})}),"\n",(0,r.jsx)(t.h2,{id:"instrumenting",children:"Instrumenting"}),"\n",(0,r.jsx)(t.p,{children:"Being able to breakdown your errors and logs by HTTP request can greatly speed up your triage and debugging processes."}),"\n",(0,r.jsxs)(t.p,{children:["An example of the Express instrumentation code can be found ",(0,r.jsx)(t.a,{href:"https://github.com/catalyst-monitor/catalyst-js/blob/main/packages/express/src/index.ts",children:"here"}),"."]}),"\n",(0,r.jsx)(t.h3,{id:"recording-an-http-request",children:"Recording an HTTP Request"}),"\n",(0,r.jsxs)(t.p,{children:["To record an HTTP request, simply wrap your endpoint logic with ",(0,r.jsx)(t.code,{children:"recordServerAction"}),"."]}),"\n",(0,r.jsx)(t.p,{children:"Ideally, this wrapping happens within a middleware layer, so you don't need to wrap every endpoint individually."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:'import Catalyst from "@catalyst-monitor/server";\n\nCatalyst.getReporter().recordServerAction(\n  {\n    method: "get", // Any method string, like \'get\', \'post\', \'put\', or even a custom string.\n    pathPattern: "/todos/{todoId}", // The pattern used by the action to serve this request\n    rawPath: "/todos/abc123", // The actual path\n    args: { todoId: "abc123" },\n    headers: {\n      /* all headers */\n    }, // All the headers. The headers will be used for propagation.\n  },\n  async (setStatusCode) => {\n    // Do work here...\n\n    // Within this callback, console logs will automatically get reported and associated\n    // with this action by default.\n    console.warn("This is a warning");\n\n    setStatusCode(200);\n  }\n);\n'})}),"\n",(0,r.jsx)(t.p,{children:"Catalyst is not opinionated on the format of the path pattern. For best results, always pass in the path pattern and param separately. This will give you an aggregate view of logs and errors per path pattern, while still letting you drill down on individual visits."}),"\n",(0,r.jsx)(t.h2,{id:"optional-associating-user-info",children:"(Optional) Associating User Info"}),"\n",(0,r.jsxs)(t.p,{children:["You can associate user info with the current request context using ",(0,r.jsx)(t.code,{children:"setUserInfo"})," inside the callback for ",(0,r.jsx)(t.code,{children:"recordServerAction"}),". This will show up in the Catalyst dashboard UI associated with the request, and may help you debug."]}),"\n",(0,r.jsxs)(t.p,{children:["Note that ",(0,r.jsx)(t.code,{children:"setUserInfo"})," is not opinionated about the ID or username format, and will not enforce uniqueness. You can set it to whatever you want. All it does is send it to Catalyst to display."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:'import Catalyst from "@catalyst-monitor/server";\n\nCatalyst.getReporter().recordServerAction(\n  {\n    // See above\n  },\n  async (setStatusCode) => {\n    Catalyst.getReporter().setUserInfo({\n      loggedInName: "any-string",\n      loggedInId: "any-string",\n    });\n\n    // Removes the user info for the current request, if it\'s been previously set.\n    // Does nothing if no user info was set.\n    Catalyst.getReporter().setUserInfo(null);\n  }\n);\n'})})]})}function h(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>o,a:()=>i});var r=n(7294);const a={},s=r.createContext(a);function i(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);