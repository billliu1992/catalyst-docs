"use strict";(self.webpackChunkcodebase_doctor_docs=self.webpackChunkcodebase_doctor_docs||[]).push([[356],{8065:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var n=s(5893),a=s(1151);const r={sidebar_position:4},i="Express.js",o={id:"install/javascript/express",title:"Express.js",description:"These are the installation instructions for Express. Installation for generic Node.js frameworks can be found here.",source:"@site/docs/install/javascript/express.md",sourceDirName:"install/javascript",slug:"/install/javascript/express",permalink:"/docs/install/javascript/express",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"React with React Router",permalink:"/docs/install/javascript/react-router"},next:{title:"Other Web Frameworks",permalink:"/docs/install/javascript/other-web"}},l={},c=[{value:"Add the dependencies",id:"add-the-dependencies",level:2},{value:"Initialize the library",id:"initialize-the-library",level:2},{value:"Record HTTP requests",id:"record-http-requests",level:2},{value:"Propagate Session Info",id:"propagate-session-info",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,a.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"expressjs",children:"Express.js"}),"\n",(0,n.jsxs)(t.p,{children:["These are the installation instructions for ",(0,n.jsx)(t.a,{href:"https://expressjs.com/",children:"Express"}),". Installation for generic Node.js frameworks can be found ",(0,n.jsx)(t.a,{href:"other-node",children:"here"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["For a working example, please checkout our ",(0,n.jsx)(t.a,{href:"https://github.com/catalyst-monitor/catalyst-examples",children:"examples repo"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"add-the-dependencies",children:"Add the dependencies"}),"\n",(0,n.jsx)(t.p,{children:"To get started, add the Catalyst dependencies:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",metastring:'title="Terminal"',children:"npm install @catalyst-monitor/core @catalyst-monitor/express\n\n# Alternatively, if you use Yarn:\nyarn add @catalyst-monitor/core @catalyst-monitor/express\n"})}),"\n",(0,n.jsx)(t.h2,{id:"initialize-the-library",children:"Initialize the library"}),"\n",(0,n.jsx)(t.p,{children:"Initialize the library as early as possible:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",metastring:'title="index.ts"',children:"import { installNodeBase } from '@catalyst-monitor/core/node'\n\nconst sdf = installNodeBase({\n  privateKey: '<YOUR PRIVATEY KEY HERE>', // The private key from the \"Settings\" page in the Catalyst dashboard.\n  systemName: 'catalyst-js-express-example',\n  version: '<YOUR VERSION CODE HERE>', // Any to differentiate different deploys, e.g. Git commit SHA\n})\n"})}),"\n",(0,n.jsx)(t.h2,{id:"record-http-requests",children:"Record HTTP requests"}),"\n",(0,n.jsx)(t.p,{children:"Install the two Catalyst middleware functions, to record requests and logs."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",metastring:'title="app.ts"',children:"import express from 'express'\nimport {\n  catalystErrorHandler,\n  catalystHandler,\n} from '@catalyst-monitor/express'\n\nconst app = express()\n\n// The Catalyst middleware should be installed as early as possible\n// to propagate any context and capture any logs and errors.\napp.use(catalystHandler)\n\n// YOUR ROUTES HERE!\n\n// The Catalyst error handler should be installed as late as possible\n// to record any uncaught errors.\napp.use(catalystErrorHandler)\n"})}),"\n",(0,n.jsx)(t.h2,{id:"propagate-session-info",children:"Propagate Session Info"}),"\n",(0,n.jsxs)(t.p,{children:["To ensure session info is correctly propagated, simply replace ",(0,n.jsx)(t.code,{children:"fetch(...)"})," calls to servers with the provided ",(0,n.jsx)(t.code,{children:"catalystNodeFetch"}),". If the backend has Catalyst installed, then the request will be associated with the calling session."]}),"\n",(0,n.jsxs)(t.p,{children:["Note that ",(0,n.jsx)(t.code,{children:"catalystNodeFetch"})," has the same interface as ",(0,n.jsx)(t.code,{children:"fetch"}),", so you can simply drop the new function in."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",metastring:'title="api.ts"',children:"import { catalystNodeFetch as cFetch } from '@catalyst-monitor/core/node'\n\nawait cFetch(\"https://.../api/widget/123\", {\n  method: method,\n})\n"})})]})}function p(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},1151:(e,t,s)=>{s.d(t,{Z:()=>o,a:()=>i});var n=s(7294);const a={},r=n.createContext(a);function i(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);