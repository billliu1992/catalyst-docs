"use strict";(self.webpackChunkcodebase_doctor_docs=self.webpackChunkcodebase_doctor_docs||[]).push([[677],{8287:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var s=n(5893),a=n(1151);const r={sidebar_position:2},i="SvelteKit",o={id:"install/javascript/sveltekit",title:"SvelteKit",description:"You can install the Catalyst client library for SvelteKit to immediately get the full feature set of Catalyst, including:",source:"@site/docs/install/javascript/sveltekit.md",sourceDirName:"install/javascript",slug:"/install/javascript/sveltekit",permalink:"/docs/install/javascript/sveltekit",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Next.js (App Router)",permalink:"/docs/install/javascript/nextjs"},next:{title:"React with React Router",permalink:"/docs/install/javascript/react-router"}},l={},d=[{value:"1. Add the dependency",id:"1-add-the-dependency",level:2},{value:"2. Create or edit your hook files",id:"2-create-or-edit-your-hook-files",level:2},{value:"3. Add the Catalyst component",id:"3-add-the-catalyst-component",level:2},{value:"4 (Optional). Associate user info",id:"4-optional-associate-user-info",level:2},{value:"Server",id:"server",level:3},{value:"Client",id:"client",level:3},{value:"Finished! Test your implementation.",id:"finished-test-your-implementation",level:2}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"sveltekit",children:"SvelteKit"}),"\n",(0,s.jsxs)(t.p,{children:["You can install the Catalyst client library for ",(0,s.jsx)(t.a,{href:"https://kit.svelte.dev/",children:"SvelteKit"})," to immediately get the full feature set of Catalyst, including:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Frontend navigation, error reporting, and click tracking"}),"\n",(0,s.jsx)(t.li,{children:"Server logs, request, and error reporting"}),"\n",(0,s.jsx)(t.li,{children:"Session tracking across the stack"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["A fully runnable example can be found ",(0,s.jsx)(t.a,{href:"https://github.com/catalyst-monitor/catalyst-examples/tree/main/js/sveltekit",children:"on Github"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["For other frameworks and languages, checkout our ",(0,s.jsx)(t.a,{href:"/docs/category/install-catalyst",children:"other installation guides"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Before you start, you'll need to sign up for Catalyst and have your keys ready, as detailed ",(0,s.jsx)(t.a,{href:"/docs/signup",children:"here"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"1-add-the-dependency",children:"1. Add the dependency"}),"\n",(0,s.jsx)(t.p,{children:"To get started, add the Catalyst dependencies:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",metastring:'title="Terminal"',children:"npm install @catalyst-monitor/sveltekit@v0.1.1\n\n# Alternatively, if you use Yarn:\nyarn add @catalyst-monitor/sveltekit@v0.1.1\n"})}),"\n",(0,s.jsx)(t.h2,{id:"2-create-or-edit-your-hook-files",children:"2. Create or edit your hook files"}),"\n",(0,s.jsxs)(t.p,{children:["Catalyst uses ",(0,s.jsx)(t.a,{href:"https://kit.svelte.dev/docs/hooks",children:"hooks"})," to get info and report on events. You can either create your hook files, or edit your hook files and wrap your existing handlers with the provided Catalyst functions."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",metastring:'title="src/hooks.client.js"',children:'import {\n  Catalyst,\n  catalystClientErrorHandler,\n} from "@catalyst-monitor/sveltekit/client";\n\nCatalyst.start({\n  publicKey: "<YOUR PUBLIC KEY HERE>", // The public key from the "Settings" page.\n  version: "<YOUR VERSION CODE HERE>", // Any string to differentiate different deploys, e.g. Git commit SHA\n  systemName: "catalyst-sveltekit-example-fe", // Any string to differentiate this service.\n  userAgent: window.navigator.userAgent,\n});\n\nexport const handleError = catalystClientErrorHandler((error) => {\n  // Your existing client error handler here...\n});\n'})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",metastring:'title="src/hooks.server.js"',children:'import {\n  catalystHandler,\n  wrapCatalystFetchHandler,\n  wrapCatalystServerErrorHandler,\n  Catalyst,\n} from "@catalyst-monitor/sveltekit/server";\n\ninstallNodeBase({\n  privateKey: "<YOUR PRIVATE KEY HERE>", // The private key from the "Settings" page in the Catalyst dashboard.\n  version: "<YOUR VERSION CODE HERE>", // Any string to differentiate different deploys, e.g. Git commit SHA\n  systemName: "catalyst-sveltekit-example", // Any string to differentiate this service.\n});\n\n// You can optionally pass in your existing handleError function.\nexport const handleError = wrapCatalystServerErrorHandler();\n\n// You can optionally pass in your existing handleFetch function.\nexport const handleFetch = wrapCatalystFetchHandler();\n\n// See below if you have an existing handle function.\nexport const handle = catalystHandler;\n'})}),"\n",(0,s.jsxs)(t.p,{children:["If you have your own ",(0,s.jsx)(t.code,{children:"handle"})," function, you can use the Sveltekit-provided ",(0,s.jsx)(t.a,{href:"https://kit.svelte.dev/docs/modules#sveltejs-kit-hooks",children:(0,s.jsx)(t.code,{children:"sequence"})})," function to elegantly add them together."]}),"\n",(0,s.jsxs)(t.p,{children:["We recommend putting the ",(0,s.jsx)(t.code,{children:"catalystHandler"})," first, so any changes you make in your own handlers will be reflected in Catalyst."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",metastring:'title="src/hooks.server.js"',children:'import { sequence } from "@sveltejs/kit/hooks";\n\nexport const handle = sequence(\n  catalystHandler, // as imported in the above example,\n  yourOwnHandler // as defined by you.\n);\n'})}),"\n",(0,s.jsx)(t.h2,{id:"3-add-the-catalyst-component",children:"3. Add the Catalyst component"}),"\n",(0,s.jsxs)(t.p,{children:["As soon as possible, add the ",(0,s.jsx)(t.code,{children:"Catalyst"})," component. This component will ensure navigation client-side is captured. We recommend adding this in the root ",(0,s.jsx)(t.code,{children:"+layout.svelte"}),", if possible."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-svelte",metastring:'title="src/+layout.svelte"',children:"<script>\n  import Catalyst from '@catalyst-monitor/sveltekit/Catalyst.svelte'\n<\/script>\n\n<Catalyst />\n<slot />\n"})}),"\n",(0,s.jsx)(t.h2,{id:"4-optional-associate-user-info",children:"4 (Optional). Associate user info"}),"\n",(0,s.jsxs)(t.p,{children:["You can associate user info with the current request context in both the client and server by calling ",(0,s.jsx)(t.code,{children:"setUserInfo"}),". This will show up in the Catalyst dashboard UI associated with the request, and may help you debug."]}),"\n",(0,s.jsxs)(t.p,{children:["Note that ",(0,s.jsx)(t.code,{children:"setUserInfo"})," is not opinionated about the ID or username format, and will not enforce uniqueness. You can set it to whatever you want. All it does is send it to Catalyst to display."]}),"\n",(0,s.jsx)(t.h3,{id:"server",children:"Server"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:'import { Catalyst } from "@catalyst-monitor/sveltekit/server";\n\nCatalyst.getReporter().setLoggedInUserInfo({\n  loggedInId: "any-id", // Optional\n  loggedInName: "any-username-name-email", // Optional\n});\n'})}),"\n",(0,s.jsxs)(t.p,{children:["In a more realistic setting, you'd probably handle auth inside a server-side hook. You can sequence your auth hook after ",(0,s.jsx)(t.code,{children:"catalystHandler"}),"."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",metastring:'title="src/hooks.server.js"',children:'import { Catalyst } from "@catalyst-monitor/sveltekit/server";\nimport { sequence } from "@sveltejs/kit/hooks";\n\nasync function authHandler({ event, resolve }) {\n  // Using your auth library.\n  const user = await getUserInformation(event.cookies.get("sessionid"));\n  event.locals.user = user;\n  if (user != null) {\n    Catalyst.getReporter().setLoggedInUserInfo({\n      loggedInId: "any-id", // Optional\n      loggedInName: "any-username-name-email", // Optional\n    });\n  }\n\n  return await resolve(event);\n}\n\nexport const handle = sequence(\n  catalystHandler, // Make sure this is first!\n  authHandler\n);\n'})}),"\n",(0,s.jsx)(t.h3,{id:"client",children:"Client"}),"\n",(0,s.jsx)(t.p,{children:"For the client, simply change your import."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:'import { Catalyst } from "@catalyst-monitor/sveltekit/client";\n\nCatalyst.getReporter().setLoggedInUserInfo({\n  loggedInId: "any-id", // Optional\n  loggedInName: "any-username-name-email", // Optional\n});\n'})}),"\n",(0,s.jsx)(t.p,{children:"In a more realistic setting, you'd likely want to listen to auth changes and set your user info accordingly."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-svelte",metastring:'title="src/routes/+layout.svelte',children:'\n<script lang="ts">\n\timport { onMount } from \'svelte\'\n  import { getCatalystWeb } from "@catalyst-monitor/sveltekit/client";\n\n\tonMount(() => {\n\t\tconst { unsubscribe } = onAuthStateChange((user) => { // onAuthStateChange provided by your auth library.\n\t\t\tgetCatalystWeb().setUserInfo(\n        user != null\n        ? {\n            loggedInId: user.id,\n            loggedInUserName: user.name\n          }\n        : null)\n\t\t})\n\t\treturn () => unsubscribe()\n\t})\n<\/script>\n'})}),"\n",(0,s.jsxs)(t.p,{children:["If you run into any issues, feel free to reach out on ",(0,s.jsx)(t.a,{href:"https://discord.gg/YQZy4SXzmX",children:"Discord"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"finished-test-your-implementation",children:"Finished! Test your implementation."}),"\n",(0,s.jsx)(t.p,{children:"You've finished setting up Catalyst! You can test your implementation by creating a component that always errors out:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-svelte",metastring:'title="+page.svelte"',children:"<script>\n  throw new Error('Error!')\n<\/script>\n\n<div>You should get an error!</div>\n"})}),"\n",(0,s.jsxs)(t.p,{children:["If you have any issues during set up, please reach out either ",(0,s.jsx)(t.a,{href:"mailto:bill@privium.xyz",children:"through e-mail"})," or ",(0,s.jsx)(t.a,{href:"https://discord.gg/YQZy4SXzmX",children:"via Discord"}),"."]})]})}function h(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>o,a:()=>i});var s=n(7294);const a={},r=s.createContext(a);function i(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);