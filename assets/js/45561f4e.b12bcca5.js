"use strict";(self.webpackChunkcodebase_doctor_docs=self.webpackChunkcodebase_doctor_docs||[]).push([[826],{6731:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>r,toc:()=>l});var s=n(5893),o=n(1151);const i={sidebar_position:1},a="Next.js (App Router)",r={id:"install/nextjs",title:"Next.js (App Router)",description:"These are the installation instructions for Next.js. For other Node.js or web frameworks, checkout our other installation guides.",source:"@site/docs/install/nextjs.md",sourceDirName:"install",slug:"/install/nextjs",permalink:"/docs/install/nextjs",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Install Catalyst",permalink:"/docs/category/install-catalyst"},next:{title:"React with React Router",permalink:"/docs/install/react-router"}},c={},l=[{value:"Add the dependency",id:"add-the-dependency",level:2},{value:"Update your Next.js config",id:"update-your-nextjs-config",level:2},{value:"Add the CatalystInstaller component",id:"add-the-catalystinstaller-component",level:2},{value:"Propagate Session Info",id:"propagate-session-info",level:2},{value:"Server Components",id:"server-components",level:3},{value:"Client Components",id:"client-components",level:3},{value:"Limitations",id:"limitations",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,o.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"nextjs-app-router",children:"Next.js (App Router)"}),"\n",(0,s.jsxs)(t.p,{children:["These are the installation instructions for ",(0,s.jsx)(t.a,{href:"https://nextjs.org/",children:"Next.js"}),". For other Node.js or web frameworks, checkout our ",(0,s.jsx)(t.a,{href:"./",children:"other installation guides"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"add-the-dependency",children:"Add the dependency"}),"\n",(0,s.jsx)(t.p,{children:"To get started, add the Catalyst dependencies:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",metastring:'title="Terminal"',children:"npm install @catalyst-monitor/nextjs\n\n# Alternatively, if you use Yarn:\nyarn add @catalyst-monitor/nextjs\n"})}),"\n",(0,s.jsx)(t.h2,{id:"update-your-nextjs-config",children:"Update your Next.js config"}),"\n",(0,s.jsxs)(t.p,{children:["Wrap your existing Next.js configuration with ",(0,s.jsx)(t.code,{children:"withCatalystConfig"}),". This will auto-instrument Catalyst code for your entire Next.js app."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",metastring:'title="next.config.mjs"',children:"import * as catalystConfig from '@catalyst-monitor/nextjs/config'\nimport catalyst from './catalyst.mjs'\n\n/** @type {import('next').NextConfig} */\nexport default catalystConfig.withCatalystConfig(\n  {\n    // Optional but suggested:\n    // Strict Mode causes effects to be ran twice in dev mode.\n    // Since Catalyst sometimes runs in effects, this causes\n    // double-reporting of events.\n    reactStrictMode: false,\n\n    // Your existing Next.js configuration here...\n  },\n  {\n    systemName: 'catalyst-nextjs-example', // The name given to this service. All endpoints will be grouped by this name.\n    publicKey: 'YOUR PUBLIC KEY HERE', // The public key from the \"Settings\" page in the Catalyst dashboard.\n    privateKey: 'YOUR PRIVATE KEY HERE', // The private key from the \"Settings\" page in the Catalyst dashboard.\n    version: 'YOUR VERSION CODE HERE', // Any to differentiate different deploys, e.g. Git commit SHA\n  }\n)\n"})}),"\n",(0,s.jsx)(t.h2,{id:"add-the-catalystinstaller-component",children:"Add the CatalystInstaller component"}),"\n",(0,s.jsxs)(t.p,{children:["As soon as possible, add the ",(0,s.jsx)(t.code,{children:"CatalystInstaller"})," component. This component will ensure everything happening client-side is captured. We recommend adding this in the root layout, if possible."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",metastring:'title="layout.ts"',children:"import { CatalystInstaller } from '@catalyst-monitor/nextjs/server'\n\nexport default function Layout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return <>\n    <CatalystInstaller />\n    {children}\n  </>\n}\n"})}),"\n",(0,s.jsx)(t.h2,{id:"propagate-session-info",children:"Propagate Session Info"}),"\n",(0,s.jsxs)(t.p,{children:["Replace ",(0,s.jsx)(t.code,{children:"fetch(...)"})," calls with the provided functions detailed below. This will ensure session info is correctly propagated."]}),"\n",(0,s.jsxs)(t.p,{children:["Note that both functions have the same interface as ",(0,s.jsx)(t.code,{children:"fetch"}),", so you can simply drop the new functions in."]}),"\n",(0,s.jsx)(t.h3,{id:"server-components",children:"Server Components"}),"\n",(0,s.jsxs)(t.p,{children:["Use ",(0,s.jsx)(t.code,{children:"catalystNodeFetch"})," in server components."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-tsx",metastring:'title="page.tsx"',children:"import { catalystNodeFetch as cFetch } from '@catalyst-monitor/nextjs/server'\n\nexport default async function Page() {\n  const resp = await cFetch(\"/api/widget/123\")\n  // ... rest of your component code\n}\n"})}),"\n",(0,s.jsx)(t.h3,{id:"client-components",children:"Client Components"}),"\n",(0,s.jsxs)(t.p,{children:["Use ",(0,s.jsx)(t.code,{children:"catalystWebFetch"})," in client components."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-tsx",metastring:'title="page.tsx"',children:"'use client'\n\nimport { catalystWebFetch as cFetch } from '@catalyst-monitor/nextjs/client'\n\nexport default function Page() {\n  useEffect(() => {\n    const resp = await cFetch(\"/api/widget/123\")\n    // ...\n  }, [])\n  // ... rest of your component code\n}\n"})}),"\n",(0,s.jsx)(t.h2,{id:"limitations",children:"Limitations"})]})}function p(e={}){const{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>r,a:()=>a});var s=n(7294);const o={},i=s.createContext(o);function a(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);